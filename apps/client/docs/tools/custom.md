# 自定义工具

除了平台提供的内置工具外，硅信还允许您创建符合特定需求的自定义工具。本页面介绍如何创建、配置和使用自定义工具。

## 自定义工具概述

自定义工具是您根据特定需求创建的个性化功能扩展，使智能联系人能够执行特定任务或连接外部服务。通过自定义工具，您可以极大地扩展联系人的能力范围，使其更好地满足您的工作和生活需求。

## 自定义工具类型

硅信平台支持多种类型的自定义工具：

### 工作流工具

通过可视化编排创建的自动化流程：

- **特点**：无需编程，通过拖拽和连接组件创建
- **适用场景**：需要多步骤操作和条件分支的复杂任务
- **详细信息**：[工作流编排](/tools/workflows/)

### API工具

连接外部API服务的工具：

- **特点**：通过配置HTTP请求连接第三方服务
- **适用场景**：需要获取外部系统数据或使用外部服务功能
- **详细信息**：[API工具配置](/tools/api-config)

### 数据连接工具

连接数据库和数据源的工具：

- **特点**：配置数据库连接并定义查询和操作
- **适用场景**：需要查询、分析或操作结构化数据
- **优势**：避免手动数据处理，提高效率

### 自定义脚本工具

通过编写代码创建的高度自定义工具：

- **特点**：使用JavaScript/Python编写功能逻辑
- **适用场景**：需要高度定制化功能且内置工具无法满足
- **优势**：最大的灵活性和定制能力

## 创建自定义工具

### 基本步骤

1. 在硅信主界面，点击"智能工具"
2. 选择"创建自定义工具"按钮
3. 选择工具类型（工作流、API、数据连接或脚本）
4. 根据所选类型，进入相应的创建界面
5. 完成工具配置和测试
6. 保存并发布工具

### 工具配置要点

创建任何类型的自定义工具时，需要设置以下基本信息：

1. **工具名称**：简洁明了的名称，方便识别
2. **描述**：详细说明工具的功能和用途
3. **图标**：选择合适的图标（可选）
4. **参数定义**：定义工具需要的输入参数
5. **输出格式**：指定工具返回结果的格式
6. **权限设置**：配置工具的使用权限和限制
7. **版本管理**：设置版本号和更新说明

## API工具详解

### 创建API工具

1. 选择"API工具"类型
2. 配置基本信息（名称、描述等）
3. 设置API详情：
   - **请求URL**：API的端点地址
   - **请求方法**：GET/POST/PUT/DELETE等
   - **请求头**：设置必要的HTTP头信息
   - **请求参数**：定义查询参数或请求体
   - **认证信息**：配置API密钥或认证凭据
4. 设置参数映射：
   - 定义工具参数如何传递给API
   - 设置默认值和验证规则
5. 配置响应处理：
   - 定义如何解析API响应
   - 设置错误处理策略
6. 测试API连接并保存

### API工具示例

**天气查询工具**：

```
名称：城市天气查询
URL：https://api.weather.com/forecast
方法：GET
参数：
  - city（用户输入的城市名）
  - days（预报天数，默认3）
响应处理：
  - 提取温度、湿度、天气状况
  - 格式化为友好的文本回复
```

**新闻搜索工具**：

```
名称：新闻搜索
URL：https://api.news.com/search
方法：POST
参数：
  - keyword（搜索关键词）
  - category（新闻类别，可选）
  - date（日期范围，可选）
响应处理：
  - 提取标题、来源、发布日期、摘要
  - 按相关性排序并限制返回数量
```

## 数据连接工具详解

### 创建数据连接工具

1. 选择"数据连接工具"类型
2. 配置基本信息
3. 设置数据源连接：
   - **数据源类型**：SQL数据库、NoSQL数据库、Excel等
   - **连接信息**：服务器地址、认证凭据等
   - **连接池设置**：并发连接数等
4. 定义查询或操作：
   - SQL查询或命令
   - 数据操作语句
   - 参数化查询设置
5. 配置结果处理：
   - 数据转换和格式化
   - 结果筛选和排序
   - 错误处理策略
6. 测试连接和查询，然后保存

### 数据工具使用示例

**销售数据分析**：

```
数据源：公司销售数据库
查询：SELECT product, SUM(amount) FROM sales
      WHERE date BETWEEN :start_date AND :end_date
      GROUP BY product ORDER BY SUM(amount) DESC
参数：
  - start_date（开始日期）
  - end_date（结束日期，默认今天）
结果处理：
  - 生成销售额排名
  - 计算环比增长
  - 创建可视化图表
```

## 脚本工具详解

### 创建脚本工具

1. 选择"脚本工具"类型
2. 配置基本信息
3. 编写工具脚本：
   - 选择编程语言（JavaScript/Python）
   - 在内置编辑器中编写代码
   - 使用平台提供的API和库
4. 定义参数和返回值：
   - 声明工具参数及其类型
   - 指定返回值格式
5. 设置脚本执行环境：
   - 内存和执行时间限制
   - 允许访问的外部资源
6. 测试脚本功能并保存

### 脚本工具示例

**文本分析工具**（JavaScript）：

```javascript
function analyzeText(text, options) {
  // 参数：text（要分析的文本）, options（分析选项）

  const wordCount = text.split(/\s+/).length;
  const charCount = text.length;
  const sentenceCount = text.split(/[.!?]+/).length - 1;

  // 计算阅读时间（基于平均阅读速度）
  const readingTimeMin = Math.ceil(wordCount / 200);

  // 关键词提取（如果选项中启用）
  let keywords = [];
  if (options.extractKeywords) {
    // 简化的关键词提取逻辑
    const words = text.toLowerCase().split(/\W+/);
    const wordFreq = {};
    words.forEach(word => {
      if (word.length > 3) {
        wordFreq[word] = (wordFreq[word] || 0) + 1;
      }
    });

    keywords = Object.entries(wordFreq)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 5)
      .map(entry => entry[0]);
  }

  return {
    wordCount,
    charCount,
    sentenceCount,
    readingTimeMin,
    keywords,
  };
}
```

## 使用自定义工具

### 分配给联系人

创建自定义工具后，需要将其分配给联系人：

1. 进入联系人设置
2. 选择"工具管理"
3. 在"自定义工具"部分，找到您创建的工具
4. 启用工具并设置权限
5. 保存设置

### 在对话中使用

使用自定义工具的方式与内置工具相同：

1. **自然对话**：联系人会根据对话内容和权限设置自动使用工具
2. **明确指令**：直接指示联系人使用特定工具
   - 例如：`使用我的天气查询工具检查明天上海的天气`
3. **命令格式**：使用特定命令语法
   - 例如：`/tool 销售数据分析 start_date=2023-01-01 end_date=2023-03-31`

## 最佳实践

### 设计原则

创建高效自定义工具的建议：

1. **明确目标**：定义工具要解决的具体问题
2. **简化复杂性**：将复杂任务分解为清晰步骤
3. **参数设计**：只要求必要的参数，提供合理默认值
4. **错误处理**：妥善处理异常情况和错误输入
5. **用户反馈**：提供清晰的进度和结果反馈
6. **性能优化**：确保工具响应迅速，避免不必要的计算

### 安全注意事项

使用自定义工具时的安全考虑：

1. **数据保护**：谨慎处理敏感数据和个人信息
2. **API密钥管理**：安全存储API密钥和凭据
3. **权限控制**：严格限制工具的访问范围
4. **输入验证**：防止注入攻击和恶意输入
5. **资源限制**：设置适当的资源使用限制

## 下一步

- 了解[工作流编排](/tools/workflows/)详细指南
- 探索[API工具配置](/tools/api-config)的高级选项
- 设置工具的[权限管理](/tools/permissions)
- 查看使用自定义工具的[最佳案例](/tools/case-studies)（即将推出）
